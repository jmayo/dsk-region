<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<title>Sistema de Gestión de Personal</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, 
	maximum-scale=1" />
	<!--css-->
	<link rel="stylesheet" type="text/css" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" href="js/jquery-ui-1.11.2.custom/jquery-ui.css" />
	<link rel="stylesheet" type="text/css" href="css/index.css" />
	<!--js-->
	<script src="js/jquery-1.11.1.min.js" type="text/javascript"></script>
	<script src="js/jquery-ui-1.11.2.custom/jquery-ui.js" type="text/javascript"></script>
	<script src="lib/jquery.iframe-transport.js" type="text/javascript"></script>
	
  
   <script src="bootstrap-3.3.2-dist/js/bootstrap.min.js"></script>
	<!--Esta se puede quitar ya que se cargara en las librerias del modelado-->
	<!--<script src="js/index.js" type="text/javascript"> </script>-->
	<!--Librerias de backbone-->
	<script type="text/javascript" src="lib/underscore.js"></script>
	<script type="text/javascript" src="lib/handlebars-v1.3.0.js"></script>
    <script type="text/javascript" src="lib/backbone.js"></script>
    <!--Librerias del modelado con backbone-->
    <script type="text/javascript" src="js/app.js"></script>
    
    <script type="text/javascript" src="js/models/validacion.js"></script>
    
    <script type="text/javascript" src="js/models/catalogo.js"></script>
    <script type="text/javascript" src="js/models/personal.js"></script>
    <script type="text/javascript" src="js/models/empresa.js"></script>
    <script type="text/javascript" src="js/models/sucursal.js"></script>
    
    <script type="text/javascript" src="js/collections/catalogos.js"></script>
    <script type="text/javascript" src="js/collections/personas.js"></script>
	<script type="text/javascript" src="js/collections/empresas.js"></script>
	<script type="text/javascript" src="js/collections/sucursales.js"></script>


	<script src="js/notificaciones.js" type="text/javascript"></script>

</head>
<body>
	<!-- para notificaciones -->
	<div class="info message" id="notify_info">
		<h3>Hey, esto te puede interesar!</h3>
		<p>Descripción de información adicional</p>
	</div>
	<div class="error message" id="notify_error">
		<h3>Oops, un error ha ocurrido</h3>
		<p></p>
	</div>
	<div class="warning message" id="notify_warning">
		<h3>Espera, esto es importante!</h3>
		<p>Descripción de advertencia</p>
	</div>
	<div class="success message" id="notify_success">
		<h3>Los datos fueron guardados con exito!</h3>
		<p></p>
	</div>
	<!-- termina notificaciones -->
	<header>
	</header>
	<nav>
		<ul class="menu">
			<li><a class="personal" href="#"></a></li>
			<li><a class="empresas" href="#"></a></li>
			<li><a class="catalogos" href="#"></a></li>
			<li><a class="cerrar_sesion" href="#"></a></li>
		</ul>
	</nav>
	<div class="caja_acciones">
			<ul class="menu_acciones">
                       <li><a href="#" class="nuevo"></a></li>
                       <li><a href="#" class="eliminar"></a></li>
                       <li><a href="#" class="guardar"></a></li>
                       <li><input type="text" placeholder="Buscar" class="buscar"/></li>
			</ul>

			<!-- <form enctype="multipart/form-data">
			    <label>File<input name='file' type='file'  id="imagencontrol" /></label>
			    <br>
			    <label>Name<input name='name' type='text' /></label>
			    <br>
			    <input type="submit" value="Upload">
			</form> -->

		<div hidden class="divResultados">
				<!-- Template:	resultados-busqueda-template	 -->
	    </div>
	</div>

		 <section class="contenido contenido_personal" id="personal_basicos" hidden>	
				<!-- Template:	personal-detalle-template	 -->
		 </section>	
		  <section class="contenido contenido_empresa">	  
		  	   <article class="div_empresa_servicio" id="listado_empresa_sucursal">
		  	   	<div id="sucursal_padre">
		  	   	</div>
		  	   	<div  id="sucursal_listado"> </div>
		 <!-- Template:	resultados-empresa-sucursal-listado-template  -->
		  	   </article>
		  	   <article  class="bloque" id="bloque_empresa">
		<!-- Template:	empresa-detalle-template	 -->
		  	   </article>
		  	   <article id="bloque_sucursal" class="bloque">
		<!-- Template:	sucursal-detalle-template	 -->
		  	   </article>


		<article id="bloque_mapa_sucursal"  class="bloque_mapa">
				<div class="titulo_mapa" id="idubicacion">
					Ubicación
				</div>
				<div id="mapa" class="caja_mapa"></div>
				<ul class="menu_cordenadas">
				<li><a class="obtener_cordenadas" href="#" title="Obtener cordenadas"></a></li>
				<li><a class="seleccionar_cordenadas" href="#" title="Seleccionar cordenadas"></a></li>
			</ul>
		</article>
		
		 </section>

	<footer>
		<ul class="redes_sociales">
			<li><a class="twitter" href="#"></a></li>
			<li><a class="facebook" href="#"></a></li>
			<li><a class="e-mail" href="#"></a></li>
		</ul>
	</footer>


<!-- ***************** Plantilla de detalle del personal ********************************* -->


<script type="text/javascript">
   
   // Funciones generales para los templates
	Handlebars.registerHelper('if', function(conditional, options) {
		  if(conditional) {
		    return options.fn(this);
		  }
		});

	Handlebars.registerHelper('ifCond', function(v1, v2, options) {
  		if(v1 === v2) {
    		return options.fn(this);
  		}
  		return options.inverse(this);
	});

	//********** Helpers ********************

	//Helper para titulos de campos
    Handlebars.registerHelper('titulos_caja',function(contenido, options){
        label_id = '';
        label_desc = options.hash.label_desc;
        if (options.hash.label_id !== undefined){
        	label_id = 'id="'+ options.hash.label_id + '"';
         }
        return '<label ' + label_id + ' for="'+ label_desc +'" class="etiquetas_bloque">'+ contenido +'</label>';
      });

	Handlebars.registerHelper('caja_imagen',function(contenido,options){
		img_id = 'id=' + options.hash.img_id;
		var ruta = Handlebars.helpers.ruta_imagen(contenido);
		var valor =  '<div class="caja_foto">'+
				    '<figure class="foto">' +
					   '<p><img ' + img_id + ' src=' + ruta + ' alt="foto" />' +
				    '</figure>' +
			    '</div>';
		return valor;
      });

	Handlebars.registerHelper('ruta_imagen',function(contenido){
		var ruta= window.ruta + 'media/';
		if(contenido===undefined || contenido===""){
			contenido='imagenes/foto.png';
		}
		ruta = ruta + contenido;
		return ruta;
	});




 	//Helper para cajas de texto
    Handlebars.registerHelper('valores_caja', function(options){
        input_id = '';
        valor = '';
        input_desc = options.hash.input_desc;
        
         if (options.hash.input_id !== undefined){
        	input_id = 'id="'+ options.hash.input_id + '"';
         }

         if (options.hash.valor !== undefined){
        	valor = 'value="'+ options.hash.valor + '"';
         }

        return '<input '+ input_id + ' class="inputs_bloque" type="text" placeholder="'+ input_desc + '" ' +valor + ' style="text-transform:uppercase ;" />';
      });

	//Helper para cajas de texto
    Handlebars.registerHelper('valores_textarea', function(options){
        valor = options.hash.valor;
    	textarea_id ='';
        textarea_desc = options.hash.textarea_desc;
    
    	if (options.hash.textarea_id !== undefined){
        	textarea_id = 'id="'+ options.hash.textarea_id + '"';
         }
        return '<textarea '+ textarea_id + ' class="textarea_bloque" placeholder="'+ textarea_desc + '">' +valor + '</textarea>';
      });


  
	


    //Helper para selectores tipo combo
    Handlebars.registerHelper('selectores_combo',function(options){
        select_id = ''; 
        select_name = options.hash.select_name;
        if (options.hash.select_id !== undefined){
        	select_id = 'id="'+ options.hash.select_id + '"';
         }
        return '<select name="' + select_name + '" class="select_bloque" ' + select_id + '> </select>'
      });

	
    //Helper para controles tipo radio
	Handlebars.registerHelper('valores_radio', function(options){
	        radio_id = ''; 
	        valor = '';
	        checado = '';
	        radio_name = options.hash.radio_name;

	        titulo = options.hash.titulo ;
	        
	        valor = 'value="'+ options.hash.valor + '" ';
	        

	        if (options.hash.radio_id !== undefined){
        	radio_id = 'id="'+ options.hash.radio_id + '"';
         	}
	         if (options.hash.checado===true){
	        	checado = 'checked="checked"';
	         }

	        label = '<label  for="' + radio_name + '"><span><span></span></span>"' + titulo + '"</label>';
	        return '<input  ' + radio_id + ' class="radio_bloque" type="radio" name="' +  radio_name + '" ' + valor + checado + '/>' + label
	      });

	// ************* Helper de agrupacion de varios controles ***********************

	 //Agrupacion de label como titulo y un input
    Handlebars.registerHelper('grp_perdet',function(contenido, options){
		var res1 =Handlebars.helpers.titulos_caja(contenido, options)
		var res2 =Handlebars.helpers.valores_caja(options)
		return '<li class="li_bloque">' + res1 + res2 + '<div class="viñeta"></div>' + '</li>';
		}
    );
  
	 //Agrupacion de label como titulo y un TextArea
    Handlebars.registerHelper('grp_perdetTextArea',function(contenido, options){
		var res1 =Handlebars.helpers.titulos_caja(contenido, options)
		var res2 =Handlebars.helpers.valores_textarea(options)
		return '<li class="li_bloque">' + res1 + res2 + '<div class="viñeta"></div>'  + '</li>';
		}
    );




    //Agrupacion de label como titulo y un combo
	Handlebars.registerHelper('grp_combo',function(contenido, options){
		var res1 =Handlebars.helpers.titulos_caja(contenido, options)
		var res2 =Handlebars.helpers.selectores_combo(options)
		return '<li class="li_bloque">' + res1 + res2 + '</li>';
		}
    );

	//Agrupacion de un label como titulo y dos radio button
	Handlebars.registerHelper('grp_options',function(contenido, options){
		var res1 =Handlebars.helpers.titulos_caja(contenido, options)
		var radio_id = options.hash.radio_id;
		options.hash.titulo = options.hash.op1_titulo;
		options.hash.valor = options.hash.op1_val;
		options.hash.checado = options.hash.op1_checado;
		options.hash.radio_id = radio_id + '_1';
		var res2 =Handlebars.helpers.valores_radio(options)

		options.hash.titulo = options.hash.op2_titulo;
		options.hash.valor = options.hash.op2_val;
		options.hash.checado = !options.hash.op1_checado;
		options.hash.radio_id = radio_id + '_2';
		var res3 =Handlebars.helpers.valores_radio(options)
	
		return '<li class="li_bloque">' + res1 + res2 +  res3 + '</li>';
		}
    );
</script>


	<!--Plantillas del personal usando handlerbars -->


  <script id="resultados-personal-busqueda-template" type="text/x-handlebars-template">
		<img  src={{{ruta_imagen imagen}}}>
		<span>{{paterno}} {{materno}} {{nombre}}</span>
		<p>{{matricula}}</p>
  </script>



<script id="personal-catalogos-template" type="text/x-handlebars-template">
	{{descripcion1}} 
</script>

<script id="personal-detalle-template" type="text/x-handlebars-template">
	<article class="bloque">
		<div class="titulo_bloque">
			Básicos
		</div>
		<div class="caja_bloque">
		<div class="campos_bloque" >
			<ul class="ul_bloque"> 
			{{{titulos_caja id label_desc="id_principal" label_id='persona_id'}}}
			{{{grp_perdet "Matricula" valor=matricula input_id='persona_matricula' label_desc='matricula_empleado' input_desc='Matricula Empleado'}}}
			{{{grp_perdet "Paterno" valor=paterno  input_id='persona_paterno' label_desc='paterno' input_desc='Paterno'}}}
			{{{grp_perdet "Materno" valor=materno  input_id='persona_materno' label_desc='materno' input_desc='Materno'}}}
			{{{grp_perdet "Nombre(s)" valor=nombre  input_id='persona_nombre' label_desc='nombres' input_desc='Nombre(s)'}}}
			{{{grp_perdet "RFC" valor=rfc  input_id='persona_rfc' label_desc='rfc' input_desc='RFC'}}}
			{{{grp_perdet "CURP" valor=curp  input_id='persona_curp' label_desc='curp' input_desc='CURP'}}}
			{{{grp_perdet "CUIP" valor=cuip  input_id='persona_cuip'   label_desc='cuip' input_desc='CUIP'}}}
			{{{grp_perdet "Fecha de Nac." valor=fec_nacimiento input_id="persona_fec_nac" label_desc='fecha_nacimiento' input_desc='Fecha de Nacimiento'}}}
			{{{grp_combo "Lugar de Nac."    label_desc='etiquetas_bloque' select_name='select_bloque' select_id='perso_edonac'}}} 
			{{{grp_combo "Municipio"   label_desc='lugar_nacimiento_municipio' select_name='municipio' select_id='perso_mpionac'}}}
			{{{grp_combo "Estado Civil"   label_desc='estado_civil' select_name='estado_civil' select_id='perso_estado_civil'}}}
			{{{grp_combo "Escolaridad"   label_desc='escolaridad' select_name='escolaridad' select_id='perso_escolaridad'}}}
			{{{grp_combo "Religión"   label_desc='religion' select_name='religion' select_id='perso_religion'}}}
			{{{grp_options "Portación"  radio_id='persona_portacion' label_desc='portacion' op1_titulo="Si" op2_titulo="No" op1_val=true op2_val=false  op1_checado=portacion radio_name='persona_portacion' input_booleano=portacion}}}   
			{{{grp_combo "Seguridad Social"   label_desc='seguridad_social' select_name='seguridad_social' select_id='perso_segsoc'}}}
			{{{grp_perdet "Id. Seguridad Social" valor=id_seguridad_social  input_id='persona_segsocial' label_desc='id_seguridad_social' input_desc='Id. Seguridad Social'}}}
			</ul>
		</div>
		</div>
	</article>
	<article class="bloque">
	<div class="titulo_bloque">
		Administración
	</div>
	<div class="caja_bloque">
		<div class="campos_bloque" id="personal_administracion">
		<ul class="ul_bloque"> 
		{{{grp_combo "Tipo de Alta"   label_desc='tipo_de_alta' select_name='tipo_de_alta' select_id='perso_tipo_de_alta'}}}
		{{{grp_perdet "Fecha de Alta" valor=fec_alta input_id="persona_fec_alta" label_desc='fecha_de_alta' input_desc='Fecha de Alta'}}}  
		{{{grp_options "Alta Condicionada"  radio_id='persona_condicionada' label_desc='alta_condicionada' op1_titulo="Si" op2_titulo="No" op1_val=true op2_val=false  op1_checado=condicionada radio_name='persona_condicionada' input_booleano=condicionada}}}   
		{{{grp_perdetTextArea "" textarea_id='persona_condicion_alta' valor=condiciones_alta   label_desc='' textarea_desc='Condición(es)'}}}
		{{{grp_combo "Administrativo"   label_desc='tipo_de_empleado' select_name='tipo_de_empleado' select_id='perso_tipo_de_empleado'}}}	
		</ul>
		</div>
	</div>
	<br>
	<div class="titulo_bloque">
		Domicilio
	</div>
	<div class="caja_bloque">
	<div class="campos_bloque">
		<ul class="ul_bloque">			
		{{{grp_perdetTextArea "Calle" valor=calle_dom textarea_id='perso_domicilio'  label_desc='' textarea_desc='Calle'}}}
		{{{grp_perdet "Número" valor=numero_dom  input_id='persona_numero_dom' label_desc='numero' input_desc='Número'}}}
		{{{grp_perdet "Colonia" valor=colonia_dom  input_id='persona_colonia_dom' label_desc='colonia' input_desc='Colonia'}}}
		{{{grp_perdet "Código Postal" valor=cp_dom  input_id='persona_cp_dom' label_desc='codigo_postal' input_desc='Código Postal'}}}
		{{{grp_combo "Estado"    label_desc='calle_estado' select_name='estado_dom' select_id='perso_estado_dom'}}} 
		{{{grp_combo "Municipio"   label_desc='calle_municipio' select_name='municipio_dom' select_id='perso_municipio_dom'}}}
		{{{grp_perdet "Ciudad/Población" valor=ciudad_dom  input_id='persona_ciudad_dom' label_desc='calle_ciudad' input_desc='Ciudad/Población'}}}
		</ul>
	</div>
	</div>
	</article>
	<article class="bloque">
		<div class="titulo_bloque">
			Foto
		</div>		
		{{{caja_imagen imagen img_id='perso_foto'}}}
		<form enctype="multipart/form-data">
		    <label>File<input name='file' type='file'  id="imagencontrol" /></label>
		    <input type="submit" value="Subir Imagen">
		</form>
	
	</article>
 </script>

 	<!--Listado de empresas usando handlerbars -->

 <script id="resultados-empresa-busqueda-template" type="text/x-handlebars-template">
		<span>{{razon_social}}</span>
		<p>{{cve_empresa}}</p>
  </script>

 <script id="resultados-empresa-sucursal-listado-template" type="text/x-handlebars-template">
		<div class="div_servicio">
		{{cve_sucursal}} {{nombre}}
		</div>
  </script>
<script id="resultados-empresa-padre-template" type="text/x-handlebars-template">
        <div class="div_empresa">
			{{cve_empresa}} {{razon_social}}
		</div>
  </script>

<script id="empresa-detalle-template" type="text/x-handlebars-template">
	<div class="titulo_bloque">
		Empresa
	</div>
	<div class="caja_bloque">
	<div class="campos_bloque">
		<ul class="ul_bloque">
		{{{titulos_caja id label_desc="id_principal" label_id='empresa_id'}}}
		{{{grp_perdet "Cve Empresa" valor=cve_empresa input_id='empresa_clave' label_desc='id_empresa' input_desc='Cve Empresa'}}}
  		{{{grp_perdetTextArea "Razón Social" textarea_id='empresa_razon_social' valor=razon_social   label_desc='razon_social' textarea_desc='Razón Social'}}}
  		{{{grp_perdet "RFC" valor=rfc input_id='empresa_rfc' label_desc='rfc' input_desc='RFC'}}}
  		{{{grp_perdetTextArea "Calle" textarea_id='empresa_calle' valor=calle   label_desc='calle' textarea_desc='Calle'}}}		
		 {{{grp_perdet "Número" valor=numero input_id='empresa_numero' label_desc='numero' input_desc='Número'}}}
		{{{grp_perdet "Colonia" valor=colonia input_id='empresa_colonia' label_desc='colonia' input_desc='Colonia'}}}
		{{{grp_perdet "Código Postal" valor=cp input_id='empresa_cp' label_desc='codigo_postal' input_desc='Código Postal'}}}
		{{{grp_combo "Estado"    label_desc='calle_estado' select_name='calle_estado' select_id='empresa_estado'}}} 
		{{{grp_combo "Municipio"    label_desc='calle_municipio' select_name='calle_municipio' select_id='empresa_municipio'}}}		
		{{{grp_perdet "Ciudad/Población" valor=ciudad input_id='empresa_ciudad' label_desc='calle_ciudad' input_desc='Ciudad/Población'}}}
		{{{grp_perdet "Teléfono 1" valor=telefono1 input_id='empresa_telefono1' label_desc='telefono1' input_desc='Teléfono 1'}}}
		{{{grp_perdet "Teléfono 2" valor=telefono2 input_id='empresa_telefono2' label_desc='telefono2' input_desc='Teléfono 2'}}}
		{{{grp_combo "Giro"    label_desc='giro' select_name='giro' select_id='empresa_giro'}}} 
		{{{grp_combo "Rubro"    label_desc='rubro' select_name='rubro' select_id='empresa_rubro'}}} 
  		{{{grp_perdet "Fecha de Alta" valor=fecha_alta input_id='empresa_fecha_alta' label_desc='fecha_de_alta' input_desc='Fecha de Alta'}}}
		</ul>
	</div>
</div>
</script>


 	<!--Detalle de la sucursal usando handlerbars -->

<script id="sucursal-detalle-template" type="text/x-handlebars-template">
	<div id="titulo_bloque_sucursal" class="titulo_bloque">
				Sucursal
	</div>
	<div class="caja_bloque">
	<div class="campos_bloque">
		<ul class="ul_bloque">
		{{{titulos_caja id label_desc="id_principal" label_id='sucursal_id'}}}	
		{{{grp_perdet "Id Sucursal" valor=cve_sucursal input_id='sucursal_cve_sucursal' label_desc='id_sucursal' input_desc='Id Sucursal'}}}
		{{{grp_perdetTextArea "Sucursal" textarea_id='sucursal_nombre' valor=nombre   label_desc='sucursal' textarea_desc='Sucursal'}}}
		{{{grp_perdetTextArea "Calle" textarea_id='sucursal_calle' valor=calle   label_desc='calle' textarea_desc='Calle'}}}
		{{{grp_perdet "Número" valor=numero  input_id='sucursal_numero'   label_desc='numero' input_desc='Número'}}}
		{{{grp_perdet "Colonia" valor=colonia   input_id='sucursal_colonia'  label_desc='colonia' input_desc='Colonia'}}}
		{{{grp_perdet "Código Postal" valor=cp  input_id='sucursal_cp'   label_desc='codigo_postal' input_desc='Código Postal'}}}
		{{{grp_combo "Estado"    label_desc='calle_estado' select_name='calle_estado' select_id='sucursal_estado'}}} 
		{{{grp_combo "Municipio"    label_desc='calle_municipio' select_name='calle_municipio' select_id='sucursal_municipio'}}}		
		{{{grp_perdet "Ciudad/Población" valor=ciudad input_id='sucursal_ciudad' label_desc='calle_ciudad' input_desc='Ciudad/Población'}}}
		{{{grp_perdet "Teléfono" valor=telefono input_id='sucursal_telefono' label_desc='telefono1' input_desc='Teléfono 1'}}}
		{{{grp_combo "Estatus"    label_desc='estatus' select_name='estatus' select_id='sucursal_estatus'}}}		
		{{{grp_perdet "Fecha de Alta" valor=fecha_alta input_id='sucursal_fecha_alta' label_desc='fecha_de_alta' input_desc='Fecha de Alta'}}}
		{{{grp_perdet "Fecha de Baja" valor=fecha_baja input_id='sucursal_fecha_baja' label_desc='fecha_de_baja' input_desc='Fecha de Baja'}}}
		{{{grp_perdet "Latitud" valor=latitud input_id='sucursal_latitud' label_desc='latitud' input_desc='Latitud'}}}
		{{{grp_perdet "Longitud" valor=longitud input_id='sucursal_longitud' label_desc='longitud' input_desc='Longitud'}}}
		</ul>
	</div>
	</div>
</script>

	<!--Otros modelos de backbone  -->
  <script type="text/javascript" src="js/views/contenido.js"></script>
   <script type="text/javascript" src="js/views/cajaOperaciones.js"></script>
  <script type="text/javascript" src="js/views/cajaBusqueda.js"></script>
  <script type="text/javascript" src="js/views/personalBusqueda.js"></script>
  <script type="text/javascript" src="js/views/personalBusquedas.js"></script>

  <script type="text/javascript" src="js/views/personalDetalle.js"></script>
  <script type="text/javascript" src="js/views/personalCatalogo.js"></script>
 <script type="text/javascript" src="js/views/personalCatalogos.js"></script> 
  <script type="text/javascript" src="js/views/empresaDetalle.js"></script>
  <script type="text/javascript" src="js/views/empresaBusqueda.js"></script> 
  <script type="text/javascript" src="js/views/empresaBusquedas.js"></script>
  <script type="text/javascript" src="js/views/sucursalListados.js"></script>
 <script type="text/javascript" src="js/views/sucursalDescripcion.js"></script>
 <script type="text/javascript" src="js/views/sucursalMapa.js"></script>
 <script type="text/javascript" src="js/views/sucursalDetalle.js"></script>
 
 
<script type="text/javascript" src="js/views/empresaDescripcion.js"></script>


<script type="text/javascript" src="js/models/formView.js"></script> 
<script type="text/javascript" src="js/views/formView.js"></script> 

  <script type="text/javascript" src="js/routers/router.js"></script>
  <script type="text/javascript" src="js/main.js"></script> 
   <script type="text/javascript" src="js/views/menu.js"></script>

   	<!--para mapas-->
 	<link rel="stylesheet" href="css/ol.css" type="text/css" />
	<script src="lib/ol.js" type="text/javascript"></script>
</body>
</html>
